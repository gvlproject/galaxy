<?xml version="1.0"?>
<tool name="GenomeSpace Exporter" id="genomespace_exporter" require_login="True" version="0.0.4">
    <description> - send data to GenomeSpace</description>
    <command interpreter="python">swiftUploader.py
        --server "genomespace-dev.genome.edu.au"
        --token "${genomespace_token}"
        #import binascii
        #import urlparse
        --file "${input1}"
        #if $filename:
            --target_url "${ $genomespace_target_dir.value + "/" + str( $filename ) }"
        #else:
            --target_url  "${ $genomespace_target_dir.value + "/" + binascii.hexlify( "Galaxy History Item %s (%s) - %s: %s.%s" % ( $__app__.security.encode_id( $input1.id ), $__app__.security.encode_id( $output_log.id ), $input1.hid, $input1.name, $input1.ext ) ) }"
        #end if
    </command>
    <inputs>
        <param format="data" name="input1" type="data" label="Send this dataset to GenomeSpace" />
        <param name="base_url" type="baseurl" />
        <param name="genomespace_target_dir" type="genomespacefile" label="Choose Target Directory" select_type="FOLDER" size="40" token_field="genomespace_token" />
        <param name="genomespace_token" type="text" label="Genomespace authentication token" size="40" />
        <!-- <param name="subdirectory" type="drill_down" display="radio" hierarchy="exact" multiple="False" optional="True" label="Choose Target Directory" dynamic_options="galaxy_code_get_genomespace_folders( genomespace_site = 'prod', trans=__trans__, value=__value__, input_dataset=input1, base_url=base_url )" help="Leave blank to generate automatically"/> -->
        <param name="filename" type="text" size="40" label="Filename" help="Leave blank to generate automatically" />
    </inputs>
    <outputs>
        <data format="html" name="output_log" />
    </outputs>
    <help>
This Tool allows you to export data to GenomeSpace. You must have logged in using your GenomeSpace OpenID. You can associate your OpenID credentials under the User Preferences panel.

If you are having trouble with this tool, click here_ to refresh your GenomeSpace token before reporting errors.

.. _here:  ${static_path}/../user/openid_auth?openid_provider=genomespace&amp;auto_associate=True

    </help>
    <options refresh="True"/>
    <code file="genomespace_exporter.py" />
</tool>
